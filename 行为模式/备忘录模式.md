# è¡Œä¸ºæ¨¡å¼â€”â€”å¤‡å¿˜å½•æ¨¡å¼
# æœ¬è´¨ï¼šä¿å­˜å’Œæ¢å¤å†…éƒ¨çŠ¶æ€
## ä¸€ã€å®šä¹‰
åœ¨ä¸ç ´åå°è£…çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»¥åå°†å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚
## äºŒã€é—®é¢˜
å®ç°ç”¨æˆ·æ’¤é”€åŠŸèƒ½(æ³¨æ„ï¼šå¯ä»¥æ’¤é”€å¤šæ¬¡å“¦ğŸ˜Š)
## ä¸‰ã€è§£å†³æ–¹æ¡ˆ
å°±ä¸‰ä¸ªç±»ã€‚åŸå‘å™¨ï¼Œå¤‡å¿˜å½•ï¼Œå‘èµ·äººã€‚å˜¿å˜¿ğŸ¤­
## å››ã€ä»£ç å®ç°
1ã€åŸå‘å™¨(Originator)
åŸå‘å™¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•ï¼Œå¹¶å­˜å‚¨å®ƒçš„å½“å‰å†…éƒ¨çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤‡å¿˜å½•æ¥æ¢å¤å…¶å†…éƒ¨çŠ¶æ€ã€‚ä¸€èˆ¬å°†éœ€è¦ä¿å­˜å†…éƒ¨çŠ¶æ€çš„ç±»è®¾è®¡ä¸ºåŸå‘èµ·ï¼Œå¦‚ä¸€ä¸ªå­˜å‚¨ç”¨æˆ·ä¿¡æ¯æˆ–å•†å“ä¿¡æ¯çš„å¯¹è±¡ã€‚
```java
package com.atmae.momento.new1;

/**
 * @Author: Mae
 * @Date: 2022/6/4
 * @Time: 10:36
 * @Description:
 */
public class Originator {
    private String state;

    public Originator(String state) {
        this.state = state;
    }

    public void setState(String state) {
        this.state = state;
    }

    public Memento createMemento() {
        return new Memento(this.state);
    }

    public String getState() {
        return this.state;
    }

    public void restoreMemento(Memento m) {
        this.state = m.getState();
    }
}

```
2ã€å¤‡å¿˜å½•(Memento)
å­˜å‚¨åŸå‘å™¨çš„å†…éƒ¨çŠ¶æ€ï¼Œæ ¹æ®åŸå‘å™¨æ¥å†³å®šä¿å­˜å“ªäº›å†…éƒ¨çŠ¶æ€ã€‚å¤‡å¿˜å½•çš„è®¾è®¡ä¸€èˆ¬å¯ä»¥å‚è€ƒåŸå‘å™¨çš„è®¾è®¡ï¼Œæ ¹æ®å®é™…éœ€è¦ç¡®å®šå¤‡å¿˜å½•ç±»ä¸­çš„å±æ€§ã€‚æ³¨æ„ï¼šé™¤äº†åŸå‘å™¨æœ¬èº«ä¸è´Ÿè´£äººç±»ä¹‹å¤–ï¼Œ
å¤‡å¿˜å½•å¯¹è±¡ä¸èƒ½ç›´æ¥æ‹±å…¶ä»–ç±»ä½¿ç”¨ï¼Œå› æ­¤å¤‡å¿˜å½•çš„è®¾è®¡åœ¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸­å®ç°çš„æœºåˆ¶æœ‰æ‰€åŒºåˆ«.
```java
package com.atmae.momento.new1;

/**
 * @Author: Mae
 * @Date: 2022/6/4
 * @Time: 10:36
 * @Description:
 */
public class Memento {
    private String state;


    public Memento(String state) {
        this.state = state();
    }


    public void setState(String state) {
        this.state = state;
    }

    public String getState() {
        return this.state;
    }
}


```
3ã€è´Ÿè´£äºº(Caretaker)
è´Ÿè´£äººåˆç§°ç®¡ç†è€…ï¼Œå¥¹è´Ÿè´£ä¿å­˜å¤‡å¿˜å½•ï¼Œä½†æ˜¯ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œæ“ä½œæˆ–æ£€æŸ¥ã€‚åœ¨è´Ÿè´£äººç±»ä¸­å¯ä»¥å­˜å‚¨ä¸€ä¸ªæˆ–å¤šä¸ªå¤‡å¿˜å½•å¯¹è±¡ï¼Œå®ƒåªè´Ÿè´£å­˜å‚¨å¯¹è±¡ï¼Œè€Œä¸èƒ½ä¿®æ”¹å¯¹è±¡ï¼Œä¹Ÿæ— éœ€çŸ¥é“å¯¹è±¡çš„å®ç°ç»†èŠ‚ã€‚
```java
package com.atmae.momento.new1;

import java.util.ArrayList;
import java.util.List;

/**
 * @Author: Mae
 * @Date: 2022/6/4
 * @Time: 10:36
 * @Description:
 */
public class Caretaker {
    private List<Memento> mementos=new ArrayList<>();

    public Memento getMemento() {
        if (mementos.isEmpty()) {
            try {
                throw new Exception("å½“å‰æ‚¨æ²¡æœ‰ä¿å­˜ï¼Œæ— æ³•æ’¤é”€");
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        Memento memento = mementos.get(mementos.size() - 1);
        mementos.remove(memento);
        return memento;
    }

    public void setMemento(Memento memento) {
        if (mementos.size() >= 5) {
            try {
                throw new Exception("æ‚¨ä¿å­˜æ’¤é”€ä¸èƒ½å¤§äºäº”æ¬¡!");
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        mementos.add(memento);
    }
}

```
4ã€å®¢æˆ·ç«¯
```java
package com.atmae.momento.new1;

/**
 * @Author: Mae
 * @Date: 2022/6/4
 * @Time: 10:44
 * @Description:
 */
public class Client {
    public static void main(String[] args) {
        Caretaker caretaker = new Caretaker();
        Originator originator = new Originator("ä½ å¥½");
        //å­˜æ¡£
        caretaker.setMemento(originator.createMemento());
        System.out.println(originator.getState());
        originator.setState("Hello World!");
        System.out.println(originator.getState());
        //æ¢å¤
        originator.restoreMemento(caretaker.getMemento());
        System.out.println(originator.getState());
    }
}
```
## äº”ã€UMLå›¾
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/300057a883984bd7a9bb4b815fb5b3c7.png#pic_center)

## å…­ã€å¤‡å¿˜å½•æ¨¡å¼é€‚ç”¨åœºæ™¯
- ä¿å­˜ä¸€ä¸ªå¯¹è±¡åœ¨æŸä¸€ä¸ªæ—¶åˆ»çš„çŠ¶æ€æˆ–éƒ¨åˆ†çŠ¶æ€ï¼Œè¿™æ ·ä»¥åéœ€è¦æ—¶å®ƒèƒ½å¤Ÿæ¢å¤åˆ°å…ˆå‰çš„çŠ¶æ€
- å¦‚æœç”¨ä¸€ä¸ªæ¥å£æ¥è®©å…¶ä»–å¯¹è±¡å¾—åˆ°è¿™äº›çŠ¶æ€ï¼Œå°†ä¼šæš´éœ²å¯¹è±¡çš„å®ç°ç»†èŠ‚å¹¶ç ´åå¯¹è±¡çš„å°è£…æ€§ï¼Œä¸€ä¸ªå¯¹è±¡ä¸å¸Œæœ›å¤–ç•Œç›´æ¥è®¿é—®å…¶å†…éƒ¨çŠ¶æ€ï¼Œé€šè¿‡è´Ÿè´£äººå¯ä»¥é—´æ¥è®¿é—®å…¶å†…éƒ¨çŠ¶æ€ã€‚
## ä¸ƒã€æ€»ç»“
### ä¼˜ç‚¹
- æä¾›äº†ä¸€ç§æ¢å¤çš„å®ç°æœºåˆ¶ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°å›åˆ°ä¸€ä¸ªç‰¹å®šåœ°å†å²æ­¥éª¤ï¼Œå½“æ–°çš„çŠ¶æ€æ— æ•ˆæˆ–è€…å­˜åœ¨é—®é¢˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…ˆå»å­˜å‚¨åœ°å¤‡å¿˜å½•å°†çŠ¶æ€å¤åŸ
- å®ç°äº†ä¿¡æ¯çš„å°è£…ï¼Œä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡æ˜¯ä¸€ç§åŸå‘å™¨å¯¹è±¡çš„è¡¨ç¤ºï¼Œä¸ä¼šè¢«å…¶ä»–ä»£ç æ”¹åŠ¨ï¼Œç®€åŒ–äº†åŸå‘å™¨å¯¹è±¡ï¼Œå¤‡å¿˜å½•åªä¿å­˜åŸå‘å™¨çš„çŠ¶æ€ï¼Œé‡‡ç”¨å †æ ˆæ¥å­˜å‚¨å¤‡å¿˜å½•å¯¹è±¡å¯ä»¥å®ç°å¤šæ¬¡æ’¤é”€æ“ä½œï¼Œ
 å¯ä»¥é€šè¿‡åœ¨è´Ÿè´£äººä¸­å®šä¹‰é›†åˆå¯¹è±¡æ¥å­˜å‚¨å¤šä¸ªå¤‡å¿˜å½•
### ç¼ºç‚¹
- èµ„æºæ¶ˆè€—è¿‡å¤§ï¼Œå¦‚æœç±»çš„æˆå‘˜å˜é‡å¤ªå¤šï¼Œå°±ä¸å¯é¿å…å ç”¨å¤§é‡çš„å†…å­˜ï¼Œè€Œä¸”æ¯ä¿å­˜ä¸€æ¬¡å¯¹è±¡çš„çŠ¶æ€éƒ½éœ€è¦æ¶ˆè€—å†…å­˜èµ„æºï¼Œå¦‚æœçŸ¥é“è¿™ä¸€ç‚¹å¤§å®¶å°±å®¹æ˜“ç†è§£ä¸ºä»€ä¹ˆæä¾›æ’¤é”€åŠŸèƒ½çš„è½¯ä»¶åœ¨è¿è¡Œæ—¶æ‰€éœ€çš„å†…å­˜å’Œç¡¬ç›˜ç©ºé—´æ¯”è¾ƒå¤§äº†
## å…«ã€ä¸å…¶ä»–æ¨¡å¼çš„å…³ç³»
- å¤‡å¿˜å½•æ¨¡å¼å’ŒåŸå‹æ¨¡å¼
 è¿™ä¸¤ä¸ªæ¨¡å¼å¯ä»¥ç»„åˆä½¿ç”¨.
åœ¨åŸå‘å™¨å¯¹è±¡ï¼ˆå‘èµ·äººå¯¹è±¡ï¼‰åˆ›å»ºå¤‡å¿˜å½•å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœåŸå‘å™¨å¯¹è±¡ä¸­å…¨éƒ¨æˆ–è€…å¤§éƒ¨åˆ†çš„çŠ¶æ€éƒ½éœ€è¦ä¿å­˜ï¼Œä¸€ä¸ªç®€æ´çš„æ–¹å¼å°±æ˜¯ç›´æ¥å…‹éš†ä¸€ä¸ªåŸå‘å™¨å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™å¤‡å¿˜å½•å¯¹è±¡é‡Œé¢å­˜æ”¾çš„æ˜¯ä¸€ä¸ªåŸå‘å™¨å¯¹è±¡çš„å®ä¾‹ã€‚
